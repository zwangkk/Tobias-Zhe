---
title: "owner-analysis"
author: "Zhe"
format: html
---

## Exercise: Explore, Clean, and Wrangle Data
```{r}
#| messgae: false
#| warning: false 
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(here)
```

Explore the data
```{r}
lobster_abundance <- read_csv(here::here("data/Lobster_Abundance_All_Years_20220829.csv"))
head(lobster_abundance)
glimpse(lobster_abundance)
unique(lobster_abundance$MONTH)
```

Q1 Converting missing values using 'mutate()' and 'na_if()'
```{r}
lobster_abundance <- lobster_abundance %>% 
  mutate(SIZE_MM = na_if(SIZE_MM, -99999))
```
Q2filter() practice
```{r}
not_napl <- lobster_abundance %>% 
  filter(SITE != "NAPL")
unique(not_napl$SITE)
```
Q3 Create and store a subset 
```{r}
aque_70mm <- lobster_abundance %>% 
  filter(SITE == "AQUE" & SIZE_MM >= 70)
```

Q4 Find the maximum carapace length 
```{r}
max_lobster <- lobster_abundance %>% 
  group_by(SITE, MONTH) %>% 
  summarize(MAX_LENGTH = max(SIZE_MM, na.rm = TRUE))
```

## Exercise: Data Visualization
Q5 Create a multi-panel plot of lobster carapace length
```{r}
#| warning: false
ggplot(data = lobster_abundance,
       aes(x = SIZE_MM))+
  geom_histogram(binwidth = 8, fill = 'yellow', color = 'grey') +
  facet_wrap(~SITE)
```

Q6 Create a line graph of the number of total lobsters observed by year
```{r}
#| warning: false
#| message: false
lobsters_summarize <- lobster_abundance %>% 
  group_by(SITE, YEAR) %>% 
  summarize(COUNT = n()) %>% 
  ungroup()
#line plot
ggplot(data = lobsters_summarize, 
       aes(x = YEAR,
           y = COUNT))+
  geom_line(aes(color = SITE))+
  theme(legend.position = "bottom",
          axis.ticks.y = element_blank())
# line and point plot
ggplot(data = lobsters_summarize, aes(x = YEAR, y = COUNT)) +
  geom_point(aes(color = SITE)) +
  geom_line(aes(color = SITE))+
  theme(legend.position = "bottom",
          axis.ticks.y = element_blank())
```

Q7 Create a bar graph that shows the amount of small and large sized carapace lobsters
```{r}
#| warning: false
#| message: false
lobster_size_lrg <- lobster_abundance %>%
    filter(YEAR %in% c(2019, 2020, 2021)) %>%
    mutate(SIZE_BIN = if_else(SIZE_MM <= 70, true = "small", false = "large")) %>%
    group_by(SITE, SIZE_BIN) %>%
    summarize(COUNT = n()) %>%
    drop_na()
# bar plot
ggplot(data = lobster_size_lrg, aes(x = SITE, y = COUNT, fill = SIZE_BIN)) +
    geom_col()
#doged bar plot

ggplot(data = lobster_size_lrg, aes(x = SITE, y = COUNT, fill = SIZE_BIN)) +
    geom_col(position = "dodge")
```






